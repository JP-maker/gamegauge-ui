<div class="form-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Nouveau mot de passe</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      
      <!-- Erreur -->
      <div *ngIf="error" class="alert alert-danger mb-3 p-2 text-center" style="color: red; background: #ffebee; border-radius: 4px;">
        {{ error }}
      </div>

      <!-- Succès -->
      <div *ngIf="isSuccess" class="text-center py-4">
        <h4 style="color: green;">Succès !</h4>
        <p>Votre mot de passe a été modifié.</p>
        <a routerLink="/login" mat-raised-button color="primary" class="w-100 mt-3">
          Se connecter maintenant
        </a>
      </div>

      <!-- Formulaire (caché si succès) -->
      <form *ngIf="!isSuccess" [formGroup]="resetForm" (ngSubmit)="onSubmit()">
        
        <p class="text-secondary small mb-3 text-center">
          Choisissez un nouveau mot de passe sécurisé.
        </p>

        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Nouveau mot de passe</mat-label>
          <input matInput formControlName="password" type="password">
          <mat-error *ngIf="resetForm.get('password')?.hasError('required')">Requis.</mat-error>
          <mat-error *ngIf="resetForm.get('password')?.hasError('minlength')">6 caractères minimum.</mat-error>
        </mat-form-field>

        <button mat-raised-button color="primary" type="submit" class="w-100 mt-2" [disabled]="resetForm.invalid || isLoading || !!error">
          <mat-progress-spinner *ngIf="isLoading" mode="indeterminate" diameter="20" color="accent" style="display:inline-block; margin-right:5px"></mat-progress-spinner>
          <span *ngIf="!isLoading">Valider</span>
          <span *ngIf="isLoading">Modification...</span>
        </button>

      </form>
    </mat-card-content>
  </mat-card>
</div>