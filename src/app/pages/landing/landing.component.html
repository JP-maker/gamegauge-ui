<!-- Fichier : src/app/pages/landing/landing.component.html -->

<!-- SECTION 1 : HÉROS (Introduction) -->
<div class="section-container hero-section">
  <div class="section-content">
    <h1>Bienvenue sur GameGauge</h1>
    <p class="subtitle">Le moyen le plus simple de suivre les scores de vos jeux de société, sans prise de tête.</p>
    <p>Commencez immédiatement ci-dessous ou <a routerLink="/register">créez un compte</a> pour sauvegarder vos parties et accéder à votre historique.</p>
  </div>
</div>

<!-- SECTION 2 : TABLEAU DE SCORE RAPIDE (Partie Interactive) -->
<div class="section-container board-section">
  <div class="section-content">

    <!-- 
      Logique d'affichage principale :
      - Si `guestBoard` existe, on affiche le template #boardView.
      - Sinon, on affiche le template #startView.
    -->
    <ng-container *ngIf="guestBoard; else startView">
      <ng-container *ngTemplateOutlet="boardView"></ng-container>
    </ng-container>

    <!-- TEMPLATE 1 : Vue "Démarrer une partie" -->
    <ng-template #startView>
      <div class="start-board-cta">
        <h2>Prêt à jouer ?</h2>
        <button mat-stroked-button color="accent" (click)="startQuickPlay()">
          <mat-icon>play_circle_filled</mat-icon>
          Démarrer une Partie Rapide
        </button>
      </div>
    </ng-template>

    <!-- TEMPLATE 2 : Vue du tableau de scores -->
    <ng-template #boardView>
      <!-- En-tête du tableau -->
      <div class="header">
        <!-- ============================================ -->
        <!-- VERSION ORDINATEUR (Caché sur petit écran)   -->
        <!-- ============================================ -->
        <div class="desktop-only">
          <h1>{{ guestBoard?.name }}</h1>
          <span class="spacer"></span>
          <button mat-stroked-button (click)="openManageParticipantsDialog()">
            <mat-icon>groups</mat-icon>
            Gérer les participants
          </button>
          <button mat-stroked-button (click)="restartGame()">
            <mat-icon>restart_alt</mat-icon>
            Recommencer
          </button>
          <button mat-stroked-button color="warn" (click)="resetGuestBoard()">
            <mat-icon>delete_sweep</mat-icon>
            Effacer la partie
          </button>
        </div>
        <!-- ============================================ -->
        <!-- VERSION MOBILE (Visible uniquement sur petit écran) -->
        <!-- ============================================ -->
        <div class="mobile-only">
          
          <!-- Le petit bouton rond avec 3 points -->
          <button mat-icon-button [matMenuTriggerFor]="mobileMenu" aria-label="Options de la partie">
            <mat-icon>more_vert</mat-icon>
          </button>

          <!-- Le menu qui s'ouvre -->
          <mat-menu #mobileMenu="matMenu">
            
            <button mat-menu-item (click)="openManageParticipantsDialog()">
              <mat-icon>group</mat-icon>
              <span>Gérer participants</span>
            </button>

            <button mat-menu-item (click)="restartGame()">
              <mat-icon>refresh</mat-icon>
              <span>Recommencer</span>
            </button>

            <button mat-menu-item (click)="resetGuestBoard()">
              <mat-icon color="warn">delete</mat-icon>
              <span class="text-danger">Effacer la partie</span>
            </button>

          </mat-menu>

        </div>
      </div>

      <!-- 
        Utilisation de notre composant réutilisable.
        On lui passe l'objet `guestBoard` en entrée.
        On écoute ses événements de sortie (`addScore`, `manageParticipants`) pour ouvrir les dialogues.
      -->
      <app-scoreboard
        [board]="guestBoard"
        [gameStatus]="gameStatus" 
        (addScore)="openAddScoreDialog($event)"
        (manageParticipants)="openManageParticipantsDialog()">
      </app-scoreboard>

    </ng-template>

  </div>
</div>

<!-- SECTION 3 : APPEL À L'ACTION (CTA pour l'inscription) -->
<div class="section-container cta-section">
  <div class="section-content">
    <h2>Prêt à sauvegarder votre partie ?</h2>
    <p>Créez un compte gratuit pour enregistrer cette partie et bien d'autres !</p>
    <a mat-stroked-button color="accent" routerLink="/register">Créer mon compte et sauvegarder</a>
  </div>
</div>