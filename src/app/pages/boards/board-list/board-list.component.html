<div class="container">
  <h1>Mes Tableaux de Scores</h1>

  <!-- On utilise le pipe async pour souscrire à l'observable boards$ -->
 <div *ngIf="!isLoading; else loading">
    
    <!-- Si la liste est vide -->
    <div *ngIf="boards.length === 0" class="empty-state">
      <mat-icon>scoreboard</mat-icon>
      <p>Vous n'avez aucun tableau de scores pour le moment.</p>
      <button mat-raised-button color="primary" (click)="openCreateBoardDialog()">Créer un premier tableau</button>>
    </div>

    <!-- Si la liste contient des tableaux -->
    <div *ngIf="boards.length > 0" class="board-grid">
      <div class="board-grid"
         cdkDropList
         [cdkDropListData]="boards"
         (cdkDropListDropped)="onDrop($event)">
        <mat-card *ngFor="let board of boards" class="board-card" cdkDrag>
          <div class="drag-handle" cdkDragHandle>
            <mat-icon>drag_indicator</mat-icon>
          </div>
          <div class="card-content" [routerLink]="['/boards', board.id]">
            <mat-card-header>
              <mat-card-title>{{ board.name }}</mat-card-title>
              <mat-card-subtitle>
                {{ board.participants.length }} participant(s)
              </mat-card-subtitle>
            </mat-card-header>
          </div>

          <!-- NOUVELLE SECTION D'ACTIONS EN HAUT DE LA CARTE -->
          <mat-card-actions class="card-actions-header">
            <span class="spacer"></span>
            <button mat-icon-button [matMenuTriggerFor]="cardMenu" (click)="$event.stopPropagation()" aria-label="Menu d'actions de la carte">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #cardMenu="matMenu">
              <button mat-menu-item (click)="onDeleteBoard(board.id, board.name, $event)">
                <mat-icon>delete</mat-icon>
                <span>Supprimer</span>
              </button>
            </mat-menu>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>

  </div>

  <!-- Template affiché pendant le chargement -->
  <ng-template #loading>
    <div class="loading-spinner">
      <mat-spinner></mat-spinner>
    </div>
  </ng-template>

  <!-- Bouton flottant pour créer un nouveau tableau -->
  <button mat-fab color="accent" class="fab-add-button" aria-label="Créer un nouveau tableau" (click)="openCreateBoardDialog()">
    <mat-icon>add</mat-icon>
  </button>
</div>